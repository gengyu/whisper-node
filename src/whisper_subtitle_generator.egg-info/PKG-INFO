Metadata-Version: 2.4
Name: whisper-subtitle-generator
Version: 1.0.0
Summary: Video speech recognition and subtitle generation with multiple Whisper engines
Home-page: https://github.com/whisper-subtitle/whisper-subtitle
Author: Whisper Subtitle Team
Author-email: Your Name <your.email@example.com>
License: MIT
Keywords: whisper,speech-to-text,subtitles,video,audio
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: fastapi>=0.104.1
Requires-Dist: uvicorn[standard]>=0.24.0
Requires-Dist: python-multipart>=0.0.6
Requires-Dist: aiofiles>=23.2.1
Requires-Dist: ffmpeg-python>=0.2.0
Requires-Dist: yt-dlp>=2023.11.16
Requires-Dist: openai-whisper>=20231117
Requires-Dist: faster-whisper>=0.10.0
Requires-Dist: celery>=5.3.4
Requires-Dist: redis>=5.0.1
Requires-Dist: sqlalchemy>=2.0.23
Requires-Dist: alembic>=1.12.1
Requires-Dist: requests>=2.31.0
Requires-Dist: pydantic>=2.5.0
Requires-Dist: python-dotenv>=1.0.0
Requires-Dist: click>=8.1.7
Requires-Dist: rich>=13.7.0
Provides-Extra: dev
Requires-Dist: pytest>=7.4.3; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.1; extra == "dev"
Requires-Dist: black>=23.11.0; extra == "dev"
Requires-Dist: flake8>=6.1.0; extra == "dev"
Dynamic: author
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-python

# Whisper Subtitle Generator

ğŸ¬ **ä¸“ä¸šçš„å¤šå¼•æ“è¯­éŸ³è¯†åˆ«ä¸å­—å¹•ç”Ÿæˆå·¥å…·**

å®ç°è§†é¢‘è¯­éŸ³è¯†åˆ«ï¼Œè‡ªåŠ¨æ·»åŠ å­—å¹•çš„åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§è¯­éŸ³è¯†åˆ«å¼•æ“ï¼Œæä¾›Webç•Œé¢ã€APIæ¥å£å’Œæ¡Œé¢åº”ç”¨ã€‚

[![CI/CD Pipeline](https://github.com/whisper-subtitle/whisper-subtitle/workflows/CI/CD%20Pipeline/badge.svg)](https://github.com/whisper-subtitle/whisper-subtitle/actions)
[![Docker Pulls](https://img.shields.io/docker/pulls/whispersubtitle/whisper-subtitle)](https://hub.docker.com/r/whispersubtitle/whisper-subtitle)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python Version](https://img.shields.io/badge/python-3.8%2B-blue)](https://www.python.org/downloads/)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ å¤šå¼•æ“æ”¯æŒ
- **OpenAI Whisper** - å…¨å¹³å°æ”¯æŒï¼Œé«˜ç²¾åº¦è¯†åˆ«
- **Faster Whisper** - Windows/Linuxä¼˜åŒ–ï¼Œæ”¯æŒtiny/medium/large-v2æ¨¡å‹
- **WhisperKit** - macOS Mç³»åˆ—èŠ¯ç‰‡ä¸“ç”¨ï¼Œlarge-v2æ¨¡å‹
- **Whisper.cpp** - å…¨å¹³å°C++å®ç°ï¼Œlarge-v2æ¨¡å‹æ¨è
- **é˜¿é‡Œäº‘ASR** - äº‘ç«¯è¯†åˆ«æœåŠ¡ï¼Œå…¨å¹³å°æ”¯æŒ

### ğŸŒ å¤šç§éƒ¨ç½²æ–¹å¼
- **Webåº”ç”¨** - ç°ä»£åŒ–å“åº”å¼ç•Œé¢
- **REST API** - å®Œæ•´çš„RESTfulæ¥å£
- **å‘½ä»¤è¡Œå·¥å…·** - æ‰¹é‡å¤„ç†å’Œè‡ªåŠ¨åŒ–
- **æ¡Œé¢åº”ç”¨** - macOS/Linux/Windowså®¢æˆ·ç«¯
- **Dockerå®¹å™¨** - ä¸€é”®éƒ¨ç½²å’Œæ‰©å±•

### ğŸ“¹ å…¨æ ¼å¼æ”¯æŒ
- **è§†é¢‘æ ¼å¼**: MP4, AVI, MOV, MKV, WEBM, FLV
- **éŸ³é¢‘æ ¼å¼**: MP3, WAV, FLAC, M4A, AAC, OGG
- **è¾“å‡ºæ ¼å¼**: SRT, VTT, TXT, JSON
- **YouTubeæ”¯æŒ**: ç›´æ¥URLå¤„ç†å’Œé¢‘é“ç›‘æ§

### âš¡ é«˜çº§åŠŸèƒ½
- **è‡ªåŠ¨å®‰è£…** - å¼•æ“ã€æ¨¡å‹å’Œä¾èµ–è‡ªåŠ¨é…ç½®
- **é•œåƒåŠ é€Ÿ** - å›½å†…ç”¨æˆ·å‹å¥½çš„å®‰è£…ä½“éªŒ
- **æ‰¹é‡å¤„ç†** - å¤šæ–‡ä»¶å¹¶è¡Œè½¬å½•
- **å®šæ—¶ä»»åŠ¡** - YouTubeé¢‘é“è‡ªåŠ¨ç›‘æ§
- **è¿›åº¦è·Ÿè¸ª** - å®æ—¶å¤„ç†çŠ¶æ€æ˜¾ç¤º
- **å­—å¹•ä¼˜åŒ–** - æ™ºèƒ½åˆ†å‰²ã€åˆå¹¶å’Œè¿‡æ»¤

## Features

- **å¤šç§è¯­éŸ³è¯†åˆ«å¼•æ“æ”¯æŒ**:
  - OpenAI Whisper (å…¨å¹³å°)
  - Faster Whisper (Windows/Linux)
  - WhisperKit (macOS Mç³»åˆ—èŠ¯ç‰‡)
  - Whisper.cpp (å…¨å¹³å°)
  - é˜¿é‡Œäº‘ASR (å…¨å¹³å°)

- **å¤šç§æ¥å£**:
  - å‘½ä»¤è¡Œç•Œé¢ (CLI)
  - Web API (FastAPI)
  - ç°ä»£åŒ–Webç•Œé¢

- **æ–‡ä»¶æ”¯æŒ**:
  - éŸ³é¢‘æ ¼å¼: MP3, WAV, FLAC, M4A, AAC, OGG
  - è§†é¢‘æ ¼å¼: MP4, AVI, MOV, MKV, WEBM
  - YouTube URLå¤„ç†

- **è¾“å‡ºæ ¼å¼**:
  - SRT (SubRip)
  - VTT (WebVTT)
  - TXT (çº¯æ–‡æœ¬)

- **é«˜çº§åŠŸèƒ½**:
  - æ‰¹é‡å¤„ç†
  - YouTubeé¢‘é“ç›‘æ§
  - å­—å¹•æ®µè½åå¤„ç† (åˆå¹¶ã€åˆ†å‰²ã€è¿‡æ»¤)
  - åå°ä»»åŠ¡è°ƒåº¦
  - è¿›åº¦è·Ÿè¸ª

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/whisper-subtitle/whisper-subtitle.git
cd whisper-subtitle

# è¿è¡Œè‡ªåŠ¨å®‰è£…è„šæœ¬
python install.py
```

è‡ªåŠ¨å®‰è£…è„šæœ¬å°†ä¼šï¼š
- âœ… æ£€æŸ¥Pythonç‰ˆæœ¬å…¼å®¹æ€§
- âœ… åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
- âœ… å®‰è£…Pythonä¾èµ–ï¼ˆä½¿ç”¨æ¸…åé•œåƒåŠ é€Ÿï¼‰
- âœ… å®‰è£…FFmpeg
- âœ… é…ç½®WhisperKitï¼ˆmacOS Mç³»åˆ—èŠ¯ç‰‡ï¼‰
- âœ… åˆ›å»ºå¿…è¦ç›®å½•
- âœ… ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶
- âœ… è¿è¡Œå®‰è£…æµ‹è¯•

### æ–¹å¼äºŒï¼šDockeréƒ¨ç½²

```bash
# ä½¿ç”¨docker-composeï¼ˆæ¨èï¼‰
docker-compose up -d

# æˆ–ç›´æ¥ä½¿ç”¨Docker
docker run -d \
  --name whisper-subtitle \
  -p 8000:8000 \
  -v $(pwd)/uploads:/app/uploads \
  -v $(pwd)/output:/app/output \
  whispersubtitle/whisper-subtitle:latest
```

### æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨å®‰è£…

**å‰ç½®è¦æ±‚ï¼š**
- Python 3.8+ 
- FFmpeg
- Git

**æ­¥éª¤ï¼š**

1. **å®‰è£…FFmpeg**
## ğŸ³ Dockeréƒ¨ç½²

### åŸºç¡€éƒ¨ç½²

```bash
# æ‹‰å–é•œåƒ
docker pull whispersubtitle/whisper-subtitle:latest

# è¿è¡Œå®¹å™¨
docker run -d \
  --name whisper-subtitle \
  -p 8000:8000 \
  -v $(pwd)/uploads:/app/uploads \
  -v $(pwd)/output:/app/output \
  -v $(pwd)/models:/app/models \
  -e DEBUG=false \
  whispersubtitle/whisper-subtitle:latest
```

### Docker Composeéƒ¨ç½²

```bash
# ç”Ÿäº§ç¯å¢ƒ
docker-compose up -d

# å¼€å‘ç¯å¢ƒ
docker-compose --profile dev up -d

# åŒ…å«ç¼“å­˜å’Œæ•°æ®åº“
docker-compose --profile cache --profile database up -d
```

### è‡ªå®šä¹‰æ„å»º

```bash
# æ„å»ºé•œåƒ
docker build -t my-whisper-subtitle .

# å¤šå¹³å°æ„å»º
docker buildx build --platform linux/amd64,linux/arm64 -t my-whisper-subtitle .
```

## ğŸ—ï¸ å¼€å‘æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/whisper-subtitle/whisper-subtitle.git
cd whisper-subtitle

# åˆ›å»ºå¼€å‘ç¯å¢ƒ
python -m venv venv
source venv/bin/activate

# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.txt
pip install -e ".[dev]"

# å®‰è£…pre-commité’©å­
pre-commit install
```

### ä»£ç è´¨é‡æ£€æŸ¥

```bash
# ä»£ç æ ¼å¼åŒ–
black src/
isort src/

# ä»£ç æ£€æŸ¥
flake8 src/
mypy src/

# è¿è¡Œæµ‹è¯•
pytest tests/ -v --cov=whisper_subtitle

# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
make check
```

### æ„å»ºæ¡Œé¢åº”ç”¨

```bash
# æ„å»ºå½“å‰å¹³å°åº”ç”¨
python build_app.py

# æ„å»ºç‰¹å®šå¹³å°ï¼ˆéœ€è¦å¯¹åº”ç¯å¢ƒï¼‰
python build_app.py --platform windows
python build_app.py --platform macos
python build_app.py --platform linux
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. FFmpegæœªæ‰¾åˆ°**
```bash
# æ£€æŸ¥FFmpegå®‰è£…
ffmpeg -version

# é‡æ–°å®‰è£…FFmpeg
# macOS: brew install ffmpeg
# Ubuntu: sudo apt install ffmpeg
# Windows: choco install ffmpeg
```

**2. æ¨¡å‹ä¸‹è½½å¤±è´¥**
```bash
# æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹
wst models download --engine openai_whisper --model base

# ä½¿ç”¨é•œåƒä¸‹è½½
export HF_ENDPOINT=https://hf-mirror.com
wst models download --engine openai_whisper --model base
```

**3. WhisperKitä¸å¯ç”¨ï¼ˆmacOSï¼‰**
```bash
# æ£€æŸ¥ç³»ç»Ÿè¦æ±‚
system_profiler SPHardwareDataType | grep "Chip"

# æ‰‹åŠ¨å®‰è£…WhisperKit CLI
brew install whisperkit
```

**4. å†…å­˜ä¸è¶³**
```bash
# ä½¿ç”¨è¾ƒå°æ¨¡å‹
wst transcribe audio.mp3 --model tiny

# è°ƒæ•´å¹¶å‘ä»»åŠ¡æ•°
export MAX_CONCURRENT_TASKS=1
```

**5. ç«¯å£è¢«å ç”¨**
```bash
# ä½¿ç”¨ä¸åŒç«¯å£
wst server start --port 8080

# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :8000
```

### æ—¥å¿—è°ƒè¯•

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
export DEBUG=true
export LOG_LEVEL=DEBUG

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/whisper_subtitle.log

# æ¸…ç†æ—¥å¿—
wst logs clean
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç¡¬ä»¶åŠ é€Ÿ

```bash
# GPUåŠ é€Ÿï¼ˆNVIDIAï¼‰
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# æ£€æŸ¥CUDAå¯ç”¨æ€§
python -c "import torch; print(torch.cuda.is_available())"
```

### æ¨¡å‹é€‰æ‹©å»ºè®®

| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | ç²¾åº¦ | æ¨èåœºæ™¯ |
|------|------|------|------|----------|
| tiny | 39MB | å¾ˆå¿« | ä¸€èˆ¬ | å¿«é€Ÿé¢„è§ˆ |
| base | 74MB | å¿« | å¥½ | æ—¥å¸¸ä½¿ç”¨ |
| small | 244MB | ä¸­ç­‰ | å¾ˆå¥½ | å¹³è¡¡é€‰æ‹© |
| medium | 769MB | æ…¢ | ä¼˜ç§€ | é«˜è´¨é‡éœ€æ±‚ |
| large | 1550MB | å¾ˆæ…¢ | æœ€ä½³ | ä¸“ä¸šç”¨é€” |

### æ‰¹é‡å¤„ç†ä¼˜åŒ–

```bash
# å¹¶è¡Œå¤„ç†
wst transcribe batch /path/to/files --workers 4

# ä½¿ç”¨è¾ƒå°æ¨¡å‹è¿›è¡Œæ‰¹é‡å¤„ç†
wst transcribe batch /path/to/files --model base --engine faster_whisper
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼

### è´¡çŒ®æ–¹å¼

1. **æŠ¥å‘ŠBug** - åœ¨Issuesä¸­æè¿°é—®é¢˜
2. **åŠŸèƒ½å»ºè®®** - æå‡ºæ–°åŠŸèƒ½æƒ³æ³•
3. **ä»£ç è´¡çŒ®** - æäº¤Pull Request
4. **æ–‡æ¡£æ”¹è¿›** - å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹
5. **æµ‹è¯•ç”¨ä¾‹** - æ·»åŠ æµ‹è¯•è¦†ç›–

### å¼€å‘æµç¨‹

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»ºPull Request

### ä»£ç è§„èŒƒ

- ä½¿ç”¨Blackè¿›è¡Œä»£ç æ ¼å¼åŒ–
- éµå¾ªPEP 8ç¼–ç è§„èŒƒ
- æ·»åŠ ç±»å‹æ³¨è§£
- ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- æ›´æ–°ç›¸å…³æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [OpenAI Whisper](https://github.com/openai/whisper) - å¼ºå¤§çš„è¯­éŸ³è¯†åˆ«æ¨¡å‹
- [Faster Whisper](https://github.com/guillaumekln/faster-whisper) - ä¼˜åŒ–çš„Whisperå®ç°
- [WhisperKit](https://github.com/argmaxinc/WhisperKit) - Apple Siliconä¼˜åŒ–
- [Whisper.cpp](https://github.com/ggerganov/whisper.cpp) - C++å®ç°
- [yt-dlp](https://github.com/yt-dlp/yt-dlp) - YouTubeä¸‹è½½å·¥å…·
- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£Webæ¡†æ¶

## ğŸ“ æ”¯æŒ

- ğŸ“– [æ–‡æ¡£](https://whisper-subtitle.readthedocs.io/)
- ğŸ’¬ [è®¨è®ºåŒº](https://github.com/whisper-subtitle/whisper-subtitle/discussions)
- ğŸ› [é—®é¢˜åé¦ˆ](https://github.com/whisper-subtitle/whisper-subtitle/issues)
- ğŸ“§ [é‚®ä»¶æ”¯æŒ](mailto:support@whisper-subtitle.com)

---

<div align="center">
  <p>å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªâ­ï¸</p>
  <p>Made with â¤ï¸ by Whisper Subtitle Team</p>
</div>
   # macOS
   brew install ffmpeg
   
   # Ubuntu/Debian
   sudo apt update && sudo apt install ffmpeg
   
   # Windows (ä½¿ç”¨Chocolatey)
   choco install ffmpeg
   ```

2. **å…‹éš†å’Œå®‰è£…**
   ```bash
   git clone https://github.com/whisper-subtitle/whisper-subtitle.git
   cd whisper-subtitle
   
   # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   
   # å®‰è£…ä¾èµ–
   pip install -r requirements.txt
   pip install -e .
   ```

3. **å®‰è£…ç‰¹å®šå¼•æ“**
   ```bash
   # OpenAI Whisper
   pip install -e ".[openai]"
   
   # Faster Whisper
   pip install -e ".[faster]"
   
   # YouTubeæ”¯æŒ
   pip install -e ".[youtube]"
   
   # é˜¿é‡Œäº‘ASR
   pip install -e ".[alibaba]"
   
   # å®‰è£…æ‰€æœ‰å¼•æ“
   pip install -e ".[all]"
   ```

### æ¡Œé¢åº”ç”¨ä¸‹è½½

ä» [Releasesé¡µé¢](https://github.com/whisper-subtitle/whisper-subtitle/releases) ä¸‹è½½é€‚åˆæ‚¨æ“ä½œç³»ç»Ÿçš„æ¡Œé¢åº”ç”¨ï¼š

- ğŸ **macOS**: `whisper-subtitle-macos.dmg`
- ğŸ§ **Linux**: `whisper-subtitle-linux.AppImage`
- ğŸªŸ **Windows**: `whisper-subtitle-windows.exe`

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ğŸ–¥ï¸ å‘½ä»¤è¡Œç•Œé¢

**åŸºç¡€è½¬å½•ï¼š**
```bash
# è½¬å½•å•ä¸ªæ–‡ä»¶
wst transcribe audio.mp3

# æŒ‡å®šå¼•æ“å’Œè¾“å‡ºæ ¼å¼
wst transcribe video.mp4 --engine faster_whisper --format srt

# æŒ‡å®šè¯­è¨€å’Œæ¨¡å‹
wst transcribe audio.wav --language zh --model medium

# æ‰¹é‡å¤„ç†
wst transcribe batch /path/to/files --output-dir ./output
```

**YouTubeå¤„ç†ï¼š**
```bash
# ä¸‹è½½å¹¶è½¬å½•YouTubeè§†é¢‘
wst youtube transcribe "https://www.youtube.com/watch?v=VIDEO_ID"

# æ·»åŠ é¢‘é“ç›‘æ§
wst youtube add @channelname "é¢‘é“åç§°" --engine openai_whisper

# åˆ—å‡ºç›‘æ§é¢‘é“
wst youtube list

# æ‰‹åŠ¨æ£€æŸ¥æ–°è§†é¢‘
wst youtube check

# å¯åŠ¨å®šæ—¶ç›‘æ§
wst youtube monitor --interval 3600  # æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡
```

**æœåŠ¡å™¨ç®¡ç†ï¼š**
```bash
# å¯åŠ¨WebæœåŠ¡å™¨
wst server start --host 0.0.0.0 --port 8000

# åå°è¿è¡Œ
wst server start --daemon

# åœæ­¢æœåŠ¡å™¨
wst server stop

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
wst server status
```

**ç³»ç»Ÿç®¡ç†ï¼š**
```bash
# æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯
wst info

# æ£€æŸ¥å¼•æ“çŠ¶æ€
wst check

# åˆ—å‡ºå¯ç”¨å¼•æ“
wst engines list

# å®‰è£…å¼•æ“
wst engines install faster_whisper

# ä¸‹è½½æ¨¡å‹
wst models download --engine openai_whisper --model base
```

### ğŸŒ Webç•Œé¢

1. **å¯åŠ¨æœåŠ¡å™¨ï¼š**
   ```bash
   wst server start
   ```

2. **è®¿é—®ç•Œé¢ï¼š**
   - ğŸ¬ **ä¸»ç•Œé¢**: http://localhost:8000
   - ğŸ“š **APIæ–‡æ¡£**: http://localhost:8000/docs
   - ğŸ” **äº¤äº’å¼API**: http://localhost:8000/redoc
   - â¤ï¸ **å¥åº·æ£€æŸ¥**: http://localhost:8000/api/v1/health

3. **WebåŠŸèƒ½ç‰¹æ€§ï¼š**
   - ğŸ“ æ‹–æ‹½ä¸Šä¼ æ–‡ä»¶
   - ğŸ”— YouTube URLç›´æ¥å¤„ç†
   - âš™ï¸ å¼•æ“å’Œæ¨¡å‹é€‰æ‹©
   - ğŸŒ è¯­è¨€è‡ªåŠ¨æ£€æµ‹
   - ğŸ“Š å®æ—¶è¿›åº¦æ˜¾ç¤º
   - ğŸ“¥ å¤šæ ¼å¼ä¸‹è½½
   - ğŸ“± å“åº”å¼è®¾è®¡

### ğŸ–¥ï¸ æ¡Œé¢åº”ç”¨

æ¡Œé¢åº”ç”¨æä¾›ä¸Webç•Œé¢ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†æ— éœ€æ‰‹åŠ¨å¯åŠ¨æœåŠ¡å™¨ï¼š

1. **ä¸‹è½½å¹¶å®‰è£…**å¯¹åº”å¹³å°çš„åº”ç”¨
2. **å¯åŠ¨åº”ç”¨**ï¼Œä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
3. **å¼€å§‹ä½¿ç”¨**ï¼Œäº«å—æœ¬åœ°åŒ–ä½“éªŒ

**æ¡Œé¢åº”ç”¨ä¼˜åŠ¿ï¼š**
- ğŸš€ ä¸€é”®å¯åŠ¨ï¼Œæ— éœ€é…ç½®
- ğŸ”’ æœ¬åœ°å¤„ç†ï¼Œæ•°æ®å®‰å…¨
- ğŸ’¾ ç¦»çº¿ä½¿ç”¨ï¼Œæ— éœ€ç½‘ç»œ
- ğŸ¯ ç³»ç»Ÿé›†æˆï¼Œæ–‡ä»¶å…³è”

### ğŸ Python API

```python
import asyncio
from whisper_subtitle.core.transcription import TranscriptionService
from whisper_subtitle.config.settings import Settings

async def main():
    # åˆå§‹åŒ–æœåŠ¡
    settings = Settings()
    service = TranscriptionService(settings)
    
    # è½¬å½•æœ¬åœ°æ–‡ä»¶
    result = await service.transcribe_file(
        file_path="audio.mp3",
        engine="openai_whisper",
        model="base",
        language="auto",
        output_format="srt"
    )
    
    print(f"è½¬å½•å®Œæˆ: {result.output_path}")
    print(f"å¤„ç†æ—¶é•¿: {result.duration}ç§’")
    
    # è½¬å½•YouTubeè§†é¢‘
    youtube_result = await service.transcribe_youtube(
        url="https://www.youtube.com/watch?v=VIDEO_ID",
        engine="faster_whisper",
        output_format="vtt"
    )
    
    print(f"YouTubeè½¬å½•å®Œæˆ: {youtube_result.output_path}")

# è¿è¡Œç¤ºä¾‹
if __name__ == "__main__":
    asyncio.run(main())
```

### ğŸ”Œ REST API

```python
import requests
import time

# ä¸Šä¼ æ–‡ä»¶å¹¶å¼€å§‹è½¬å½•
with open("audio.mp3", "rb") as f:
    response = requests.post(
        "http://localhost:8000/api/v1/transcribe",
        files={"file": f},
        data={
            "engine": "openai_whisper",
            "model": "base",
            "language": "auto",
            "output_format": "srt"
        }
    )

task_id = response.json()["task_id"]
print(f"ä»»åŠ¡ID: {task_id}")

# è½®è¯¢ä»»åŠ¡çŠ¶æ€
while True:
    status_response = requests.get(
        f"http://localhost:8000/api/v1/transcribe/{task_id}/status"
    )
    status = status_response.json()
    
    print(f"çŠ¶æ€: {status['status']} - è¿›åº¦: {status['progress']}%")
    
    if status["status"] == "completed":
        print(f"ä¸‹è½½é“¾æ¥: {status['download_url']}")
        break
    elif status["status"] == "failed":
        print(f"é”™è¯¯: {status['error']}")
        break
    
    time.sleep(2)
```

## âš™ï¸ é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶ (.env)

```bash
# åŸºç¡€é…ç½®
DEBUG=false
LOG_LEVEL=INFO
HOST=0.0.0.0
PORT=8000

# ç›®å½•é…ç½®
UPLOADS_DIR=./uploads
DOWNLOADS_DIR=./downloads
OUTPUT_DIR=./output
TEMP_DIR=./temp
MODELS_DIR=./models
LOGS_DIR=./logs
BIN_DIR=./bin

# æ–‡ä»¶é™åˆ¶
MAX_FILE_SIZE=500  # MB
MAX_DURATION=7200  # ç§’

# é»˜è®¤è®¾ç½®
DEFAULT_ENGINE=openai_whisper
DEFAULT_MODEL=base
DEFAULT_LANGUAGE=auto
DEFAULT_OUTPUT_FORMAT=srt

# å¼•æ“é…ç½®
OPENAI_WHISPER_ENABLED=true
FASTER_WHISPER_ENABLED=true
WHISPERKIT_ENABLED=true
WHISPER_CPP_ENABLED=true
ALIBABA_ASR_ENABLED=false

# é˜¿é‡Œäº‘ASRé…ç½®
ALIBABA_ACCESS_KEY_ID=your_access_key
ALIBABA_ACCESS_KEY_SECRET=your_secret_key
ALIBABA_REGION=cn-shanghai

# YouTubeé…ç½®
YOUTUBE_ENABLED=true
YOUTUBE_QUALITY=best[height<=720]
YOUTUBE_AUDIO_FORMAT=mp3

# ä»»åŠ¡é…ç½®
MAX_CONCURRENT_TASKS=3
TASK_TIMEOUT=3600
CLEANUP_INTERVAL=86400

# ç›‘æ§é…ç½®
MONITOR_INTERVAL=3600
MONITOR_ENABLED=false
```

### é«˜çº§é…ç½® (config.yaml)

```yaml
# å¼•æ“è¯¦ç»†é…ç½®
engines:
  openai_whisper:
    enabled: true
    models: ["tiny", "base", "small", "medium", "large"]
    default_model: "base"
    device: "auto"  # auto, cpu, cuda
    
  faster_whisper:
    enabled: true
    models: ["tiny", "base", "small", "medium", "large-v2"]
    default_model: "base"
    device: "auto"
    compute_type: "auto"  # auto, int8, float16, float32
    
  whisperkit:
    enabled: true
    models: ["large-v2"]
    default_model: "large-v2"
    
  whisper_cpp:
    enabled: true
    models: ["base", "small", "medium", "large-v2"]
    default_model: "base"
    threads: 4
    
  alibaba_asr:
    enabled: false
    region: "cn-shanghai"
    format: "pcm"
    sample_rate: 16000

# åå¤„ç†é…ç½®
post_processing:
  merge_segments:
    enabled: true
    max_gap: 2.0  # ç§’
    min_duration: 1.0  # ç§’
    
  filter_segments:
    enabled: true
    min_confidence: 0.5
    remove_music: true
    remove_noise: true
    
  split_segments:
    enabled: false
    max_duration: 30.0  # ç§’
    split_on_silence: true

# ç›‘æ§é…ç½®
monitoring:
  channels: []
  check_interval: 3600  # ç§’
  max_videos_per_check: 10
  download_quality: "best[height<=720]"
  auto_transcribe: true
  
# é€šçŸ¥é…ç½®
notifications:
  email:
    enabled: false
    smtp_server: "smtp.gmail.com"
    smtp_port: 587
    username: "your_email@gmail.com"
    password: "your_password"
    
  webhook:
    enabled: false
    url: "https://your-webhook-url.com"
    
# ç¼“å­˜é…ç½®
cache:
  enabled: true
  backend: "memory"  # memory, redis
  ttl: 3600  # ç§’
  
# æ•°æ®åº“é…ç½®
database:
  url: "sqlite:///./whisper_subtitle.db"
  # url: "postgresql://user:pass@localhost/whisper_subtitle"
```

### ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§

1. å‘½ä»¤è¡Œå‚æ•°ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. ç¯å¢ƒå˜é‡
3. .envæ–‡ä»¶
4. config.yamlæ–‡ä»¶
5. é»˜è®¤å€¼ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰
   wst --config custom-config.yaml transcribe audio.mp3
   ```

## APIæ–‡æ¡£

æœåŠ¡å™¨è¿è¡Œåï¼Œè®¿é—® http://localhost:8000/docs æŸ¥çœ‹äº¤äº’å¼APIæ–‡æ¡£ã€‚

### ä¸»è¦ç«¯ç‚¹

- `POST /api/v1/transcribe` - è½¬å½•éŸ³è§†é¢‘æ–‡ä»¶
- `POST /api/v1/upload` - ä¸Šä¼ æ–‡ä»¶è¿›è¡Œè½¬å½•
- `GET /api/v1/engines` - åˆ—å‡ºå¯ç”¨å¼•æ“
- `GET /api/v1/models` - åˆ—å‡ºå¯ç”¨æ¨¡å‹
- `POST /api/v1/youtube/channels` - æ·»åŠ YouTubeé¢‘é“ç›‘æ§
- `GET /api/v1/tasks/{task_id}` - è·å–ä»»åŠ¡çŠ¶æ€

## è¯­éŸ³è¯†åˆ«å¼•æ“

### OpenAI Whisper
- **å®‰è£…**: `pip install openai-whisper`
- **æ¨¡å‹**: tiny, base, small, medium, large
- **è¯­è¨€**: 99+ ç§è¯­è¨€
- **ç‰¹ç‚¹**: é«˜ç²¾åº¦ï¼Œå¤šè¯­è¨€æ”¯æŒ

### Faster Whisper
- **å®‰è£…**: `pip install faster-whisper`
- **æ¨¡å‹**: ä¸OpenAI Whisperç›¸åŒ
- **ç‰¹ç‚¹**: æ¨ç†é€Ÿåº¦å¿«4å€ï¼Œå†…å­˜ä½¿ç”¨æ›´å°‘

### WhisperKit (ä»…macOS)
- **è¦æ±‚**: æ­è½½Apple Siliconçš„macOS
- **ç‰¹ç‚¹**: é’ˆå¯¹Appleç¡¬ä»¶ä¼˜åŒ–

### Whisper.cpp
- **å®‰è£…**: `pip install whispercpp`
- **ç‰¹ç‚¹**: C++å®ç°ï¼Œæ¨ç†é€Ÿåº¦å¿«

### é˜¿é‡Œäº‘ASR
- **è¦æ±‚**: é˜¿é‡Œäº‘è´¦æˆ·å’ŒAPIå‡­è¯
- **ç‰¹ç‚¹**: åŸºäºäº‘ç«¯ï¼Œä¸­æ–‡è¯†åˆ«ç²¾åº¦é«˜

## å¼€å‘

### è®¾ç½®å¼€å‘ç¯å¢ƒ

```bash
git clone https://github.com/whisper-subtitle/whisper-subtitle.git
cd whisper-subtitle

# å¼€å‘æ¨¡å¼å®‰è£…
pip install -e ".[dev]"

# å®‰è£…pre-commité’©å­
pre-commit install
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
pytest --cov=whisper_subtitle

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/test_transcription.py
```

### ä»£ç æ ¼å¼åŒ–

```bash
# æ ¼å¼åŒ–ä»£ç 
black src/
isort src/

# æ£€æŸ¥ä»£ç é£æ ¼
flake8 src/
mypy src/
```

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚
 


